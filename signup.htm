<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="images/android-chrome-192x192.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />

    <title>Sign Up</title>

    <link rel="dns-prefetch" href="https://cdn.tailwindcss.com"/>
    <link rel="preconnect" href="https://cdn.tailwindcss.com" />
    <link rel="preconnect" href="https://cdn.tailwindcss.com" crossorigin/>
	  <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="//static.app.l6d.me/ajax/libs/axios/0.27.2/axios.min.js"></script>

    <link rel="preload" href="stylesheets/user.css" as="style">
    <link rel="stylesheet" type="text/css" href="stylesheets/user.css" />

</head>
<body>
  <div id="app" class="container mx-auto text-gray-900">
    <div class="min-h-screen flex flex-col justify-center items-center mx-auto w-auto">
      <div class="shadow-xl p-4 lg:p-8 bg-gray-50 rounded-xl relative -mt-20 w-1/4">
        <div class="text-center mb-4 lg:mb-8">
          <span class="text-xl lg:text-5xl mt-1 text-gray-600 font-bold">SIGN UP</span>
        </div>
        <!-- <form id="singnupForm"> -->
          <input type="hidden" id="" name="" value="" />
          <div class="relative text-gray-800 focus-within:text-gray-600 mb-2 lg:mb-6">
            <input type="text" name="username" placeholder="Username" id="username"
             class="block px-2 lg:px-4 py-1 lg:py-2 w-full rounded bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-600 focus:border-transparent" required/>
          </div>
          <div class="relative text-gray-800 focus-within:text-gray-600 mb-2 lg:mb-6">
            <input type="email" name="email" placeholder="Email" id="email" 
            class="block px-2 lg:px-4 py-1 lg:py-2 w-full rounded bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-600 focus:border-transparent" required/>
          </div>
          <div class="relative text-gray-800 focus-within:text-gray-600 mb-2 lg:mb-6">
            <input type="password" name="password" placeholder="Password" id="password" 
            class="block px-2 lg:px-4 py-1 lg:py-2 w-full rounded bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-600 focus:border-transparent" required/>
          </div>
          <div class="relative text-gray-800 focus-within:text-gray-600 mb-2 lg:mb-6">
            <input type="password" name="confirm-password" placeholder="Confirm Password" id="confirm_password" 
            class="block px-2 lg:px-4 py-1 lg:py-2 w-full rounded bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-600 focus:border-transparent" required/>
          </div>
          <div class="items-center text-center">
            <button name="button" id="singnup" type="submit" 
            class="btn bg-gray-600 hover:bg-gray-500 text-white py-1 lg:py-2 rounded-full w-2/3 inline">Sign Up</button>
          </div>
        <!-- </form> -->
        <div class="text-center text-xs pt-20 text-gray-400">
          <span class="">Have an account?</span>
          <a href="login.htm" class="hover:text-blue-400">Login</a>
        </div>
      </div>
    </div>
  </div>
  <script>
"use strict";

window.addEventListener('load', (event) => {
});

function invalidInfo(inputId='',inputEIId='', regex='', message='') {
  var vaildInput = document.getElementById(inputId);
  var input_ei = document.getElementById(inputEIId);
  if (!regex.test(vaildInput.value)) {
    if (input_ei == null) {
      var input_ei = document.createElement('p');
      input_ei.setAttribute('class', 'vaild-info');
      input_ei.setAttribute('id', inputEIId);
      input_ei.innerText = message;
      vaildInput.parentNode.appendChild(input_ei);
    }
  } else {
    if (input_ei != null) {
      vaildInput.parentNode.removeChild(input_ei);
    }
  }
}

document.getElementById('username').onchange = (event) => {
  invalidInfo('username', 'username_ei', /^[\w\-]{6,20}$/g, "This username is invalid")
}

document.getElementById('email').onchange = (event) => {
  invalidInfo('email', 'email_ei', /^[a-zA-Z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~]+\@[a-z\d\-]+\.[a-z\d]+$/g, "The email address is invalid")
}

document.getElementById('password').onchange = (event) => {
  invalidInfo('password', 'password_ei', /^[a-zA-Z0-9!\\\"\#$%&'()*+,-\./:;<=>?\@[\]^_`{|}~]{8,20}$/g, "You need to enter a password")
}

document.getElementById('confirm_password').onchange = (event) => {
  var password = document.getElementById("password").value;
  var confirm_password = document.getElementById("confirm_password");
  var confirm_password_ei = document.getElementById('confirm_password_ei');
  if (password != confirm_password.value) {
    if (confirm_password_ei == null) {
      var confirm_password_ei = document.createElement('p');
      confirm_password_ei.setAttribute('class', 'vaild-info');
      confirm_password_ei.setAttribute('id', 'confirm_password_ei');
      confirm_password_ei.innerText = "The password don't match";
      confirm_password.parentNode.appendChild(confirm_password_ei);
    }
  } else {
    if (confirm_password_ei != null) {
      confirm_password.parentNode.removeChild(confirm_password_ei);
    }
  }
}

document.getElementById("singnup").onclick = (event) => {
  if (document.getElementsByClassName('vaild-info') != null) {
    return;
  }
  axios.defaults.headers.post['Access-Control-Allow-Origin'] = '*';
  axios.defaults.withCredentials = true;
  var username = document.getElementById("username").value;
  var email = document.getElementById('email').value;
  var password = document.getElementById("password").value;
  if (username.length == 0 || email.length == 0 || password.length == 0) {
    return;
  }
  axios.post("http://127.0.0.1:8080/user/signup", {
    username: username,
    email: email,
    password: password,
  })
  .then(function (response) {
    console.log(response.data);
  })
  .catch(function (error) {
    console.log(error);
  });
}
  </script>
</body>
</html>